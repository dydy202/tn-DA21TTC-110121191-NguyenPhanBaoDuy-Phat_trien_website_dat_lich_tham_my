<!DOCTYPE html>
<html lang="vi">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta
      http-equiv="Cache-Control"
      content="no-cache, no-store, must-revalidate"
    />
    <meta http-equiv="Pragma" content="no-cache" />
    <meta http-equiv="Expires" content="0" />
    <title>Đánh Giá Dịch Vụ - Tiệm Nail Diamond</title>
    <link rel="icon" href="/favicon.ico" type="image/x-icon" />
    <link
      href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css"
      rel="stylesheet"
      integrity="sha384-QWTKZyjpPEjISv5WaRU9OFeRpok6YctnYmDr5pNlyT2bRjXh0JMhjY6hW+ALEwIH"
      crossorigin="anonymous"
    />
    <style>
      body {
        font-family: Arial, sans-serif;
        background-color: #fffaf0;
        margin: 0;
        min-height: 100vh;
        display: flex;
        flex-direction: column;
      }
      .navbar {
        background-color: #d8bea2 !important;
      }
      .navbar .nav-link,
      .navbar .navbar-brand {
        color: #000 !important;
      }
      .navbar .nav-link:hover {
        color: #fff !important;
      }
      .navbar-logo {
        border-radius: 50px;
        max-height: 80px;
      }
      .main-content {
        width: 800px;
        margin: 40px auto;
        padding: 20px;
        background: #fff;
        border-radius: 8px;
        box-shadow: 0 0 10px rgba(0, 0, 0, 0.1);
      }
      .star-rating {
        display: flex;
        justify-content: center;
        font-size: 2rem;
        margin-bottom: 20px;
        direction: ltr;
      }
      .star-rating input {
        display: none;
      }
      .star-rating label {
        cursor: pointer;
        color: #ccc;
      }
      .footer {
        background: #d8bea2;
        color: #000;
        padding: 20px 0;
        margin-top: auto;
      }
      .footer-grid {
        display: flex;
        flex-wrap: wrap;
        gap: 20px;
      }
      .footer-grid > div {
        flex: 1 1 300px;
        padding: 15px;
      }
      .footer-grid h2 {
        font-size: 24px;
        font-weight: bold;
        margin-bottom: 10px;
        text-align: left;
      }
      .footer-grid h3 {
        font-size: 20px;
        font-weight: bold;
        margin-bottom: 10px;
      }
      .footer-grid p {
        font-size: 0.9em;
        margin-bottom: 5px;
      }
      .footer-grid a {
        color: #000;
        text-decoration: none;
        transition: color 0.3s ease;
      }
      .footer-grid a:hover {
        color: #fff;
      }
      .container {
        max-width: 1200px;
        margin: 0 auto;
        padding: 0 15px;
      }
      .btn-primary {
        background-color: #d8bea2;
        border-color: #d8bea2;
      }
      .btn-primary:hover {
        background-color: #c49a82;
        border-color: #c49a82;
      }
      .btn-secondary {
        background-color: #6c757d;
        border-color: #6c757d;
      }
      .btn-secondary:hover {
        background-color: #5a6268;
        border-color: #5a6268;
      }
      a {
        color: #000;
        text-decoration: none;
      }
      a:hover {
        text-decoration: underline;
      }
    </style>
  </head>
  <body>
    <!-- Menu -->
    <nav class="navbar navbar-expand-lg navbar-light">
      <div class="container">
        <a class="navbar-brand" href="/trangchu">
          <img
            src="/uploads/logo.png"
            alt="Tiệm Nail Diamond"
            class="navbar-logo"
            style="max-height: 80px"
          />
        </a>
        <button
          class="navbar-toggler"
          type="button"
          data-bs-toggle="collapse"
          data-bs-target="#navbarNav"
          aria-controls="navbarNav"
          aria-expanded="false"
          aria-label="Toggle navigation"
        >
          <span class="navbar-toggler-icon"></span>
        </button>
        <div class="collapse navbar-collapse" id="navbarNav">
          <ul class="navbar-nav ms-auto">
            <li class="nav-item">
              <a class="nav-link" href="/trangchu">Trang chủ</a>
            </li>
            <li class="nav-item">
              <a class="nav-link" href="/gioithieu">Giới thiệu</a>
            </li>
            <li class="nav-item">
              <a class="nav-link" href="/dichvu">Dịch vụ</a>
            </li>
            <li class="nav-item">
              <a class="nav-link" href="/hocvien">Học viện</a>
            </li>
            <li class="nav-item">
              <a class="nav-link" href="/tintuc">Tin tức</a>
            </li>
            <li class="nav-item">
              <a class="nav-link" href="/album">Album</a>
            </li>
            <li class="nav-item">
              <a class="nav-link" href="/datlich?redirect=/datlich">Đặt lịch</a>
            </li>
            <li class="nav-item">
              <a class="nav-link" href="/lienhe">Liên hệ</a>
            </li>
            <% if (user) { %>
            <li class="nav-item dropdown">
              <a
                class="nav-link dropdown-toggle"
                href="#"
                id="navbarDropdown"
                role="button"
                data-bs-toggle="dropdown"
                aria-expanded="false"
              >
                <%= user.HoTenKH || 'Tài khoản' %>
              </a>
              <ul class="dropdown-menu" aria-labelledby="navbarDropdown">
                <li>
                  <a class="dropdown-item" href="/taikhoan">Sửa thông tin</a>
                </li>
                <li>
                  <a class="dropdown-item" href="/lichsu-lichhen"
                    >Lịch sử lịch hẹn</a
                  >
                </li>
                <li><a class="dropdown-item" href="/dangxuat">Đăng xuất</a></li>
              </ul>
            </li>
            <% } else { %>
            <li class="nav-item">
              <a class="nav-link" href="/dangnhap">Đăng nhập/Đăng ký</a>
            </li>
            <% } %>
          </ul>
        </div>
      </div>
    </nav>

    <!-- Nội dung chính -->
    <div class="main-content">
      <h2 class="text-center mb-4">Đánh Giá Dịch Vụ</h2>

      <!-- Hiển thị thông báo -->
      <% if (message && message.text) { %>
      <div
        class="alert alert-<%= message.type %> alert-dismissible fade show"
        role="alert"
      >
        <%= message.text %>
        <button
          type="button"
          class="btn-close"
          data-bs-dismiss="alert"
          aria-label="Close"
        ></button>
      </div>
      <% } %>

      <!-- Form đánh giá -->
      <form action="/danhgia" method="POST">
        <input type="hidden" name="_csrf" value="<%= csrfToken %>" />
        <input type="hidden" name="maCTHD" value="<%= maCTHD %>" />
        <input type="hidden" name="maKH" value="<%= user.MaKH %>" />

        <div class="mb-3 text-center">
          <label class="form-label"
            ><strong>Điểm đánh giá (1-5 sao)</strong></label
          >
          <div class="star-rating">
            <input type="radio" id="star1" name="diemDG" value="1" required />
            <label for="star1">★</label>
            <input type="radio" id="star2" name="diemDG" value="2" />
            <label for="star2">★</label>
            <input type="radio" id="star3" name="diemDG" value="3" />
            <label for="star3">★</label>
            <input type="radio" id="star4" name="diemDG" value="4" />
            <label for="star4">★</label>
            <input type="radio" id="star5" name="diemDG" value="5" />
            <label for="star5">★</label>
          </div>
        </div>

        <div class="mb-3">
          <label for="binhLuan" class="form-label">Bình luận</label>
          <textarea
            class="form-control"
            id="binhLuan"
            name="binhLuan"
            rows="4"
            placeholder="Nhập bình luận của bạn..."
          ></textarea>
        </div>

        <div class="mb-3">
          <label for="chatLuong" class="form-label">Chất lượng dịch vụ</label>
          <textarea
            class="form-control"
            id="chatLuong"
            name="chatLuong"
            rows="3"
            placeholder="Đánh giá chất lượng dịch vụ..."
          ></textarea>
        </div>

        <div class="mb-3">
          <label for="thaiDo" class="form-label">Thái độ nhân viên</label>
          <textarea
            class="form-control"
            id="thaiDo"
            name="thaiDo"
            rows="3"
            placeholder="Đánh giá thái độ nhân viên..."
          ></textarea>
        </div>

        <div class="text-center">
          <button type="submit" class="btn btn-primary">Gửi Đánh Giá</button>
          <a href="/lichsu-lichhen" class="btn btn-secondary">Quay lại</a>
        </div>
      </form>
    </div>

    <!-- Footer -->
    <footer class="footer">
      <div class="container">
        <div class="footer-grid">
          <div>
            <h2>Tiệm nail Diamond</h2>
            <h3>Địa chỉ</h3>
            <p>Hẻm 300, Khóm 1, Phường 8, Thành phố Trà Vinh, tỉnh Trà Vinh</p>
            <h3>Liên hệ</h3>
            <p>Điện thoại: <a href="tel:0784265668">0784265668</a></p>
            <p>
              Email:
              <a href="mailto:npb.duy.2002@gmail.com">npb.duy.2002@gmail.com</a>
            </p>
          </div>
          <div>
            <h3>Bản đồ</h3>
            <iframe
              src="https://www.google.com/maps/embed?pb=!1m16!1m12!1m3!1d245.63861717762805!2d106.31644629814373!3d9.915804120820384!2m3!1f0!2f0!3f0!3m2!1i1024!2i768!4f13.1!2m1!1zaOG6u20gMzAwIEtow7NtIDEgcGjGsOG7nW5nIDggVGjDoG5oIHBo4buRIFRyw6AgVmluaA!5e0!3m2!1svi!2s!4v1744661746153!5m2!1svi!2s"
              width="100%"
              height="200"
              style="border: 0; border-radius: 10px"
              allowfullscreen=""
              loading="lazy"
              referrerpolicy="no-referrer-when-downgrade"
            ></iframe>
          </div>
        </div>
      </div>
    </footer>

    <script
      src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"
      integrity="sha384-YvpcrYf0tY3lHB60NNkmXc5s9fDVZLESaAA55NDzOxhy9GkcIdslK1eN7N6jIeHz"
      crossorigin="anonymous"
    ></script>
    <!-- JavaScript cho star-rating -->
    <script>
      document.querySelectorAll(".star-rating input").forEach((star) => {
        star.addEventListener("change", function () {
          const rating = parseInt(this.value);
          const labels = document.querySelectorAll(".star-rating label");
          labels.forEach((label, index) => {
            label.style.color = index < rating ? "#ffc107" : "#ccc";
          });
        });
      });
      document.querySelectorAll(".star-rating label").forEach((label) => {
        label.addEventListener("mouseover", function () {
          const rating = parseInt(this.getAttribute("for").replace("star", ""));
          const labels = document.querySelectorAll(".star-rating label");
          labels.forEach((l, index) => {
            l.style.color = index < rating ? "#ffc107" : "#ccc";
          });
        });
        label.addEventListener("mouseout", function () {
          const checked = document.querySelector(".star-rating input:checked");
          const rating = checked ? parseInt(checked.value) : 0;
          const labels = document.querySelectorAll(".star-rating label");
          labels.forEach((l, index) => {
            l.style.color = index < rating ? "#ffc107" : "#ccc";
          });
        });
      });
    </script>
    <!-- Thêm mã Crisp -->
    <script type="text/javascript">
      window.CRISP_WEBSITE_ID = "1943f314-1b1a-49aa-9069-02eb9fe4db8a";
      (function () {
        var d = document;
        var s = d.createElement("script");
        s.src = "https://client.crisp.chat/l.js";
        s.async = 1;
        d.getElementsByTagName("head")[0].appendChild(s);
      })();
    </script>
  </body>
</html>
